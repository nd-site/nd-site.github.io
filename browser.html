<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trình duyệt ND - ND Labs</title>
  <link rel="icon" href="/logo.png">
  <style>
    :root {
      --bg: linear-gradient(135deg, #002fff, #00d9ff);
      --card: #ffffffcc;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: system-ui, sans-serif;
      background: var(--bg); display: flex; flex-direction: column; align-items: center;
    }
    header {
      width: 100%; padding: 16px; text-align: center; font-weight: 700; font-size: 22px;
      border-bottom: 1px solid #000; background: #ffffff88; backdrop-filter: blur(6px); color: #000000b7;
    }
    .wrap { width: min(820px, 92vw); margin-top: 40px; flex:1; }
    .card {
      background: var(--card); backdrop-filter: blur(8px);
      border: 1px solid #000; border-radius: 20px; box-shadow: 0 10px 30px #00000020;
      padding: 22px; 
    }
    h1 { margin: 0 0 12px; font-size: 22px; text-align:center; }
    .bar { display: grid; grid-template-columns: 1fr auto; gap: 10px; }
    input[type="text"] {
      width: 100%; padding: 14px 16px; border-radius: 14px; border: 1px solid #000;
      font-size: 16px; outline: none;
    }
    button {
      padding: 12px 16px; border-radius: 14px; border: 1px solid #000; cursor: pointer;
      background: linear-gradient(135deg, #3995ff, #9c5fff); color: #fff; font-weight: 600;
    }
    .hint { font-size: 12px; opacity: .8; margin-top: 10px; text-align:center; }
    .row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:12px; justify-content:center; }
    select { padding: 10px 12px; border-radius: 12px; border: 1px solid #000; background:#fff; }
    .toggle { display:flex; align-items:center; gap:8px; }
    label { font-size: 14px; }
    footer {
    width: 100%; padding: 12px; text-align: center; font-size: 16px; font-weight: 500;
      border-top: 1px solid #000000; background: #ffffff88; backdrop-filter: blur(6px); color: #000000c9;
    }
    .home-btn {
      margin-top:16px; text-align:center;
    }
    .toast {
      position: fixed; top: 20px; right: 20px;
      background: #fff; border: 1px solid #000; border-radius: 14px;
      padding: 12px 18px; box-shadow: 0 6px 20px #00000020;
      opacity: 0; transform: translateY(-20px);
      transition: all 0.5s ease;
    }
    .toast.show { opacity: 1; transform: translateY(0); }
  </style>
</head>
<body>
  <header>ND Labs - Trình duyệt ND</header>
  <div class="wrap">
    <div class="card">
      <div class="bar">
        <input id="q" type="text" placeholder="Tìm kiếm..." autocomplete="on" />
        <button id="go">Đi</button>
      </div>
      <div class="row">
        <div>
          <label for="engine">Công cụ tìm kiếm</label>
          <select id="engine">
            <option value="google">Google</option>
            <option value="bing">Bing</option>
            <option value="duck">DuckDuckGo</option>
          </select>
        </div>
        <div class="toggle">
          <input type="checkbox" id="newtab" />
          <label for="newtab">Mở trong tab mới</label>
        </div>
      </div>
    </div>
  </div>
  <footer>© 2025 ND Labs. All rights reserved.</footer>

  <div class="toast" id="toast">Chào mừng bạn đến với Trình duyệt ND - ND Labs</div>

  <script>
    const $q = document.getElementById('q');
    const $go = document.getElementById('go');
    const $engine = document.getElementById('engine');
    const $newtab = document.getElementById('newtab');
    const toast = document.getElementById('toast');

    const ENGINES = {
      google: (s) => `https://www.google.com/search?q=${encodeURIComponent(s)}`,
      bing:   (s) => `https://www.bing.com/search?q=${encodeURIComponent(s)}`,
      duck:   (s) => `https://duckduckgo.com/?q=${encodeURIComponent(s)}`,
    };

    function isIPv4(host) {
      if (!/^(\d{1,3}\.){3}\d{1,3}$/.test(host)) return false;
      return host.split('.').every(o => Number(o) >= 0 && Number(o) <= 255);
    }

    function normalizeUrl(input) {
      const raw = input.trim();
      if (!raw) return null;
      if (/\s/.test(raw)) return null;
      if (/^javascript:/i.test(raw)) return null;

      let candidate = raw;
      if (!/^[a-zA-Z][a-zA-Z\d+.-]*:/.test(candidate)) {
        candidate = 'https://' + candidate;
      }
      try {
        const u = new URL(candidate);
        const host = u.hostname;
        const looksHostLike = host === 'localhost' || isIPv4(host) || host.includes('.');
        if (!looksHostLike) return null;
        if (u.protocol === 'http:') u.protocol = 'https:';
        return u.href;
      } catch (e) {
        return null;
      }
    }

    function goNow(url) {
      if ($newtab.checked) {
        window.open(url, '_blank', 'noopener,noreferrer');
      } else {
        window.location.assign(url);
      }
    }

    function handleGo() {
      const val = $q.value;
      const normalized = normalizeUrl(val);
      if (normalized) {
        goNow(normalized);
      } else {
        const engine = ENGINES[$engine.value] || ENGINES.google;
        const url = engine(val.trim());
        goNow(url);
      }
    }

    $go.addEventListener('click', handleGo);
    $q.addEventListener('keydown', (e) => { if (e.key === 'Enter') handleGo(); });

    // Toast chào mừng
    window.addEventListener('load', () => {
      $q.focus();
      setTimeout(() => toast.classList.add('show'), 300);
      setTimeout(() => toast.classList.remove('show'), 4000);
    });
  </script>
  
  <div class="home-wrapper">
    <!-- Nút Trang Chủ -->
    <a href="https://nd-site.github.io" class="home-btn">
      <img src="/homebtn.png" alt="Trang chủ">
    </a>

    <style>
      .home-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 55px;
        height: 55px;
        background: #fff;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        cursor: pointer;
        z-index: 9999;
        animation: float 3s ease-in-out infinite;
        text-decoration: none;
      }
      .home-btn img {
        max-width: 60%;
        max-height: 60%;
        object-fit: contain;
      }
      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-6px); }
      }
      .home-btn:hover {
        transform: scale(1.05);
        transition: 0.3s;
      }
    </style>
  </div>
</body>
</html>
