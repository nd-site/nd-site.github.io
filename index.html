<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nhật Đăng - Trang Chủ</title>
  <link rel="icon" href="/logo.png">
  <style>
    .card { background: var(--card, #fff); backdrop-filter: blur(8px); border-radius: 20px; box-shadow: 0 10px 30px #00000020; padding: 22px; }
    .bar { display: flex; align-items: center; gap: 12px; }
    .bar input[type="text"] { flex: 1; padding: 14px 16px; border-radius: 999px; border: none; background: #e9ecef; font-size: 16px; outline: none; color: #5d6266;}
    .bar button { width: 48px; height: 48px; border-radius: 50%; border: none; cursor: pointer; background: linear-gradient(135deg, #3995ff, #9c5fff); color: #ffffff; font-weight: 600; display: flex; align-items: center; justify-content: center; font-size: 18px; }
    input[type="text"] { width: 100%; padding: 14px 16px; border-radius: 999px; border: none; background: #e9ecef; font-size: 16px; outline: none; color: #5d6266; }
    input[type="text"]::placeholder { color: #6b7178; }
    button { width: 48px; height: 48px; padding: 0; border-radius: 50%; border: none; cursor: pointer; background: linear-gradient(135deg, #3995ff, #9c5fff);color: #ffffff; font-weight: 600; display: flex; align-items: center; justify-content: center; font-size: 18px; }
    .hint { font-size: 12px; opacity: .8; margin-top: 10px; text-align:center; }
    .row { display: flex; gap:20px; align-items: center; flex-wrap: wrap; margin-top: 12px; justify-content:center; }
    .custom-select { position: relative; width: 220px; cursor: pointer; user-select: none; }
    .custom-select .selected { background: #e9ecef; border-radius: 999px; padding: 12px 16px; font-size: 16px; display: flex; align-items: center; justify-content: space-between; gap: 8px; }
    .custom-select .selected .content { display: flex; align-items: center; gap: 8px; flex: 1; justify-content: center; font-size: 16px; }
    .custom-select .selected img { width: 20px; height: 20px; }
    .custom-select .arrow { margin-left: auto; display: flex; align-items: center; justify-content: center; }
    .custom-select .arrow img { width: 10px; height: 10px; transition: transform 0.2s ease; }
    .custom-select.open .arrow img { transform: rotate(180deg); }
    .custom-select .options { display: none; position: absolute; top: 110%; left: 0; width: 100%; background: #fff; border-radius: 12px; box-shadow: 0 4px 12px #0002; z-index: 10; }
    .custom-select .options div { padding: 12px 16px; font-size: 16px; display: flex; align-items: center; gap: 8px; }
    .custom-select .selected,
    .custom-select .options div,
    .custom-select .selected .content { font-size: 16px; }
    .custom-select .options img { width: 20px; height: 20px; object-fit: contain; }
    .custom-select .selected img { object-fit: contain; vertical-align: middle; }
    .custom-select .options div { position: relative; padding: 12px 16px; font-size: 16px; display: flex; align-items: center; gap: 8px; border-radius: 8px; transition: all 0.2s ease; overflow: hidden; }
    .custom-select .options div::before { content: ""; position: absolute; inset: 0; background: rgba(0, 0, 0, 0.1); opacity: 0; transition: opacity 0.2s ease; z-index: 0; }
    .custom-select .options div:hover::before { opacity: 1; }
    .custom-select .options div:hover { background: #eef1f4; box-shadow: 0 4px 10px rgba(0,0,0,0.15); transform: translateY(-2px); }
    .custom-select .options div * { position: relative; z-index: 1; }
    .logo-google { width: 20px; height: 20px; }
    .logo-bing { width: 18px; height: 24px; }
    .logo-duck { width: 22px; height: 22px; }
    .custom-select .selected { transition: box-shadow 0.25s ease, transform 0.25s ease; }
    .bar input[type="text"]:hover,
    .bar button:hover,
    .custom-select .selected:hover { box-shadow: 0 4px 15px rgba(0,0,0,0.2); transform: translateY(-2px); }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="bar">
        <input id="q" type="text" placeholder="Tìm kiếm..." autocomplete="on" />
        <button id="go">
          <img src="/kinhlup.png" alt="" style="width: 45px; height:45px; filter: brightness(0) invert(1);" onerror="this.remove()">
        </button>
      </div>
      <div class="row">
        <div class="custom-select" id="engine">
          <div class="selected" data-value="google">
            <div class="content"><img src="/logogoogle.png" alt="" onerror="this.remove()"><span>Google</span></div>
            <span class="arrow"><img src="/muiten.png" alt=""></span>
          </div>
          <div class="options">
            <div data-value="google" data-label="Google" data-img="/logogoogle.png">
              <img src="/logogoogle.png" alt="" class="logo-google"><span>Google</span>
            </div>
            <div data-value="bing" data-label="Bing" data-img="/logobing.png">
              <img src="/logobing.png" alt="" class="logo-bing"><span>Bing</span>
            </div>
            <div data-value="duck" data-label="DuckDuckGo" data-img="/logoduckduckgo.png">
              <img src="/logoduckduckgo.png" alt="" class="logo-duck"><span>DuckDuckGo</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const $q = document.getElementById("q");
    const $go = document.getElementById("go");
    const $engine = document.getElementById("engine");

    const ENGINES = {
      google: q => `https://www.google.com/search?q=${encodeURIComponent(q)}`,
      bing: q => `https://www.bing.com/search?q=${encodeURIComponent(q)}`,
      duck: q => `https://duckduckgo.com/?q=${encodeURIComponent(q)}`
    };

    const selected = $engine.querySelector(".selected");
    const selectedContent = selected.querySelector(".content");
    const options = $engine.querySelector(".options");

    selected.addEventListener("click", () => {
      const isOpen = $engine.classList.contains("open");
      if (isOpen) {
        options.style.display = "none";
        $engine.classList.remove("open");
      } else {
        options.style.display = "block";
        $engine.classList.add("open");
      }
    });

    options.querySelectorAll(":scope > div").forEach(option => {
      option.addEventListener("click", () => {
        const imgSrc = option.dataset.img || "";
        const label = option.dataset.label || "";

        selectedContent.textContent = "";
        if (imgSrc) {
          const img = document.createElement("img");
          img.src = imgSrc;
          img.alt = "";
          img.onerror = () => img.remove();
          selectedContent.appendChild(img);
        }
        const span = document.createElement("span");
        span.textContent = label;
        selectedContent.appendChild(span);

        selected.dataset.value = option.dataset.value;
        options.style.display = "none";
        $engine.classList.remove("open");
      });
    });

    function isIPv4(host) {
      if (!/^(\d{1,3}\.){3}\d{1,3}$/.test(host)) return false;
      return host.split('.').every(o => Number(o) >= 0 && Number(o) <= 255);
    }

    function normalizeUrl(input) {
      const raw = input.trim();
      if (!raw) return null;
      if (/\s/.test(raw)) return null;
      if (/^javascript:/i.test(raw)) return null;

      let candidate = raw;
      if (!/^[a-zA-Z][a-zA-Z\d+.-]*:/.test(candidate)) {
        candidate = 'https://' + candidate;
      }
      try {
        const u = new URL(candidate);
        const host = u.hostname;
        const looksHostLike = host === 'localhost' || isIPv4(host) || host.includes('.');
        if (!looksHostLike) return null;

        if (u.protocol === 'http:') {
          return 'https://' + u.host + u.pathname + u.search + u.hash;
        }
        return u.href;
      } catch (e) {
        return null;
      }
    }

    function goNow(url) {
      window.location.assign(url);
    }

    function handleGo() {
      const val = $q.value;
      const normalized = normalizeUrl(val);
      if (normalized) {
        goNow(normalized);
      } else {
        const engineKey = selected.dataset.value || "google";
        const engine = ENGINES[engineKey];
        const url = engine(val.trim());
        goNow(url);
      }
    }

    $go.addEventListener('click', handleGo);
    $q.addEventListener('keydown', (e) => { if (e.key === 'Enter') handleGo(); });

    document.addEventListener('click', (e) => {
      if (!$engine.contains(e.target)) {
        options.style.display = 'none';
        $engine.classList.remove("open");
      }
    });
  </script>
</body>
</html>
